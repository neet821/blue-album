# ğŸ³ Blue Local å¤šç§éƒ¨ç½²æ–¹æ¡ˆå®Œæ•´æŒ‡å—

## ğŸ“‹ éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **ä¼ ç»Ÿéƒ¨ç½²** | æ€§èƒ½æœ€ä¼˜ï¼Œçµæ´»åº¦é«˜ | é…ç½®å¤æ‚ï¼Œä¾èµ–ç®¡ç†å›°éš¾ | ç”Ÿäº§ç¯å¢ƒï¼Œå¤§æµé‡ |
| **Dockeréƒ¨ç½²** | ç¯å¢ƒéš”ç¦»ï¼Œéƒ¨ç½²ç®€å•ï¼Œå¯ç§»æ¤æ€§å¼º | è½»å¾®æ€§èƒ½æŸè€— | å¼€å‘/æµ‹è¯•/ç”Ÿäº§ |
| **äº‘å¹³å°PaaS** | è‡ªåŠ¨æ‰©å±•ï¼Œè¿ç»´ç®€å• | æˆæœ¬è¾ƒé«˜ï¼Œå¹³å°ç»‘å®š | å¿«é€Ÿä¸Šçº¿ï¼Œå›¢é˜Ÿé¡¹ç›® |
| **Kubernetes** | é«˜å¯ç”¨ï¼Œè‡ªåŠ¨æ‰©å±•ï¼Œé€‚åˆå¾®æœåŠ¡ | å­¦ä¹ æˆæœ¬é«˜ï¼Œå¤æ‚ | å¤§å‹é¡¹ç›®ï¼Œä¼ä¸šçº§ |

---

## ğŸš€ æ–¹æ¡ˆä¸€ï¼šDocker éƒ¨ç½²ï¼ˆæ¨èæ–°æ‰‹ï¼‰

### ä¼˜åŠ¿
- âœ… ä¸€é”®éƒ¨ç½²ï¼Œ3åˆ†é’Ÿå®Œæˆ
- âœ… ç¯å¢ƒå®Œå…¨éš”ç¦»ï¼Œé¿å…ä¾èµ–å†²çª
- âœ… æœ¬åœ°å’ŒæœåŠ¡å™¨ä½¿ç”¨ç›¸åŒé…ç½®
- âœ… æ˜“äºè¿ç§»å’Œå¤‡ä»½

### å‰ç½®è¦æ±‚
- Docker 20.10+
- Docker Compose 1.29+

### å¿«é€Ÿå¼€å§‹

#### 1. Windowsæœ¬åœ°æ„å»ºå‰ç«¯
```bash
cd d:\Laragon\laragon\www\blue-local\frontend
npm install
npm run build
```

#### 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨
```bash
# å‹ç¼©é¡¹ç›®ï¼ˆæ’é™¤node_modulesï¼‰
# ä¸Šä¼ æ•´ä¸ªé¡¹ç›®åˆ°æœåŠ¡å™¨ /var/www/blue-local
```

#### 3. æœåŠ¡å™¨éƒ¨ç½²
```bash
cd /var/www/blue-local
chmod +x scripts/deployment/deploy-docker.sh
./scripts/deployment/deploy-docker.sh
```

#### 4. éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose ps

# è®¿é—®ç½‘ç«™
curl http://localhost
```

### Dockerå¸¸ç”¨å‘½ä»¤
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f mysql

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose restart backend

# è¿›å…¥å®¹å™¨
docker exec -it blue-local-backend bash

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats
```

### æ•…éšœæ’æŸ¥
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹å®Œæ•´æ—¥å¿—
docker-compose logs --tail=100

# é‡æ–°æ„å»º
docker-compose up -d --build --force-recreate

# æ¸…ç†å¹¶é‡æ–°éƒ¨ç½²
docker-compose down -v
docker-compose up -d --build
```

---

## ğŸ–¥ï¸ æ–¹æ¡ˆäºŒï¼šä¼ ç»ŸLinuxæœåŠ¡å™¨éƒ¨ç½²

### ä¼˜åŠ¿
- âœ… æ€§èƒ½æœ€ä¼˜ï¼Œç›´æ¥è¿è¡Œåœ¨ç³»ç»Ÿä¸Š
- âœ… å®Œå…¨æ§åˆ¶ï¼Œçµæ´»åº¦é«˜
- âœ… é€‚åˆç”Ÿäº§ç¯å¢ƒ

### ç³»ç»Ÿè¦æ±‚
- Ubuntu 20.04+ / CentOS 7+
- Python 3.9+
- MySQL 8.0+
- Nginx

### å¿«é€Ÿéƒ¨ç½²
```bash
# 1. è¿è¡Œæ‰“åŒ…è„šæœ¬ï¼ˆWindowsï¼‰
cd d:\Laragon\laragon\www\blue-local\scripts\deployment
package.bat

# 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r deploy-package user@server:/var/www/blue-local

# 3. æ‰§è¡Œéƒ¨ç½²
ssh user@server
cd /var/www/blue-local
sudo chmod +x scripts/deploy.sh
sudo ./scripts/deploy.sh
```

è¯¦è§ï¼š`docs/deployment/æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—.md`

---

## â˜ï¸ æ–¹æ¡ˆä¸‰ï¼šé˜¿é‡Œäº‘/è…¾è®¯äº‘ PaaS éƒ¨ç½²

### 3.1 é˜¿é‡Œäº‘ ECS + RDS

#### æ¶æ„
```
ç”¨æˆ· â†’ é˜¿é‡Œäº‘SLBè´Ÿè½½å‡è¡¡ â†’ ECSå®ä¾‹ï¼ˆNginx+Backendï¼‰ â†’ RDSæ•°æ®åº“
```

#### éƒ¨ç½²æ­¥éª¤

**1. åˆ›å»ºRDS MySQLå®ä¾‹**
- ç‰ˆæœ¬ï¼šMySQL 8.0
- è§„æ ¼ï¼š1æ ¸2GBï¼ˆå…¥é—¨ï¼‰
- å­˜å‚¨ï¼š20GB SSD
- åˆ›å»ºæ•°æ®åº“ï¼š`blue_local_db`

**2. åˆ›å»ºECSå®ä¾‹**
- ç³»ç»Ÿï¼šUbuntu 20.04
- è§„æ ¼ï¼š2æ ¸4GBï¼ˆæ¨èï¼‰
- å¸¦å®½ï¼š5Mbpsï¼ˆæŒ‰éœ€è°ƒæ•´ï¼‰
- å®‰å…¨ç»„ï¼šå¼€æ”¾80, 443ç«¯å£

**3. é…ç½®ç¯å¢ƒ**
```bash
# SSHè¿æ¥åˆ°ECS
ssh root@your-ecs-ip

# å®‰è£…Docker
curl -fsSL https://get.docker.com | sh

# éƒ¨ç½²é¡¹ç›®
git clone your-repo
cd blue-local
# ä¿®æ”¹.envä¸­çš„æ•°æ®åº“åœ°å€ä¸ºRDSå†…ç½‘åœ°å€
./scripts/deployment/deploy-docker.sh
```

**4. é…ç½®åŸŸåå’ŒSSL**
```bash
# å®‰è£…Certbot
apt-get install certbot

# ç”³è¯·è¯ä¹¦
certbot certonly --standalone -d yourdomain.com
```

#### æˆæœ¬ä¼°ç®—ï¼ˆæŒ‰æœˆï¼‰
- ECSï¼ˆ2æ ¸4GBï¼‰ï¼šÂ¥100-150
- RDSï¼ˆ1æ ¸2GBï¼‰ï¼šÂ¥100-200
- å¸¦å®½ï¼ˆ5Mbpsï¼‰ï¼šÂ¥30-50
- **æ€»è®¡ï¼šÂ¥230-400/æœˆ**

### 3.2 è…¾è®¯äº‘è½»é‡åº”ç”¨æœåŠ¡å™¨

#### éƒ¨ç½²æ­¥éª¤
```bash
# 1. è´­ä¹°è½»é‡åº”ç”¨æœåŠ¡å™¨
# é€‰æ‹©ï¼š2æ ¸4GBï¼Œ6Mbpsï¼Œ80GB SSDï¼ŒÂ¥99/æœˆ

# 2. é€‰æ‹©é•œåƒï¼šDocker CE

# 3. ä¸Šä¼ ä»£ç å¹¶éƒ¨ç½²
scp -r deploy-package lighthouse@your-ip:/home/lighthouse/
ssh lighthouse@your-ip
cd /home/lighthouse/deploy-package
./scripts/deployment/deploy-docker.sh
```

---

## ğŸŒ æ–¹æ¡ˆå››ï¼šVercel + PlanetScaleï¼ˆé€‚åˆæ¼”ç¤º/ä¸ªäººé¡¹ç›®ï¼‰

### æ¶æ„
- å‰ç«¯ï¼šVercelï¼ˆå…è´¹æ‰˜ç®¡ï¼‰
- åç«¯ï¼šRailway/Renderï¼ˆå…è´¹é¢åº¦ï¼‰
- æ•°æ®åº“ï¼šPlanetScaleï¼ˆå…è´¹5GBï¼‰

### ä¼˜åŠ¿
- âœ… å®Œå…¨å…è´¹ï¼ˆå°æµé‡ï¼‰
- âœ… è‡ªåŠ¨HTTPS
- âœ… å…¨çƒCDNåŠ é€Ÿ
- âœ… è‡ªåŠ¨éƒ¨ç½²

### éƒ¨ç½²æ­¥éª¤

#### 1. å‰ç«¯éƒ¨ç½²åˆ°Vercel

**åˆ›å»º `vercel.json`ï¼š**
```json
{
  "buildCommand": "cd frontend && npm run build",
  "outputDirectory": "frontend/dist",
  "framework": "vite",
  "rewrites": [
    {
      "source": "/api/:path*",
      "destination": "https://your-backend.railway.app/api/:path*"
    },
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

**éƒ¨ç½²ï¼š**
```bash
# å®‰è£…Vercel CLI
npm install -g vercel

# ç™»å½•
vercel login

# éƒ¨ç½²
cd d:\Laragon\laragon\www\blue-local
vercel --prod
```

#### 2. åç«¯éƒ¨ç½²åˆ°Railway

**åˆ›å»º `railway.toml`ï¼š**
```toml
[build]
builder = "nixpacks"

[deploy]
startCommand = "python -m uvicorn backend.main:app --host 0.0.0.0 --port $PORT"
restartPolicyType = "on-failure"
```

**éƒ¨ç½²ï¼š**
```bash
# å®‰è£…Railway CLI
npm install -g @railway/cli

# ç™»å½•
railway login

# åˆå§‹åŒ–
railway init

# éƒ¨ç½²
railway up
```

#### 3. æ•°æ®åº“é…ç½®PlanetScale

```bash
# æ³¨å†Œï¼šhttps://planetscale.com/
# åˆ›å»ºæ•°æ®åº“ï¼šblue-local-db
# è·å–è¿æ¥å­—ç¬¦ä¸²
# åœ¨Railwayè®¾ç½®ç¯å¢ƒå˜é‡ï¼šDATABASE_URL
```

---

## â˜¸ï¸ æ–¹æ¡ˆäº”ï¼šKubernetes éƒ¨ç½²ï¼ˆä¼ä¸šçº§ï¼‰

### é€‚ç”¨åœºæ™¯
- å¤§æµé‡ï¼ˆ1000+ å¹¶å‘ç”¨æˆ·ï¼‰
- éœ€è¦é«˜å¯ç”¨
- å¤šå›¢é˜Ÿåä½œ
- è‡ªåŠ¨æ‰©ç¼©å®¹

### å¿«é€Ÿå¼€å§‹

**åˆ›å»º Kubernetes é…ç½®æ–‡ä»¶ï¼š**

`k8s/deployment.yaml`:
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: blue-local-backend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: blue-local-backend
  template:
    metadata:
      labels:
        app: blue-local-backend
    spec:
      containers:
      - name: backend
        image: your-registry/blue-local:latest
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: blue-local-secrets
              key: database-url
---
apiVersion: v1
kind: Service
metadata:
  name: blue-local-backend
spec:
  selector:
    app: blue-local-backend
  ports:
  - port: 8000
    targetPort: 8000
  type: LoadBalancer
```

**éƒ¨ç½²ï¼š**
```bash
kubectl apply -f k8s/
kubectl get pods
kubectl get services
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ•°æ®åº“ä¼˜åŒ–
```sql
-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_article_author ON articles(author_id);
CREATE INDEX idx_room_host ON sync_rooms(host_user_id);
CREATE INDEX idx_member_online ON sync_room_members(is_online);

-- ä¼˜åŒ–æŸ¥è¯¢
-- ä½¿ç”¨EXPLAINåˆ†ææ…¢æŸ¥è¯¢
```

### 2. ç¼“å­˜é…ç½®
```python
# å®‰è£…Redis
pip install redis

# æ·»åŠ ç¼“å­˜å±‚
from redis import Redis
cache = Redis(host='localhost', port=6379)
```

### 3. CDNåŠ é€Ÿ
- é™æ€èµ„æºæ‰˜ç®¡åˆ°OSS
- ä½¿ç”¨é˜¿é‡Œäº‘CDN/è…¾è®¯äº‘CDN
- Cloudflareå…è´¹CDN

### 4. è´Ÿè½½å‡è¡¡
```nginx
upstream backend {
    server backend1:8000;
    server backend2:8000;
    server backend3:8000;
}

server {
    location /api {
        proxy_pass http://backend;
    }
}
```

---

## ğŸ”’ å®‰å…¨åŠ å›º

### 1. ä½¿ç”¨HTTPS
```bash
# Let's Encryptå…è´¹è¯ä¹¦
certbot --nginx -d yourdomain.com
```

### 2. é˜²ç«å¢™é…ç½®
```bash
ufw allow 22/tcp
ufw allow 80/tcp
ufw allow 443/tcp
ufw enable
```

### 3. é™æµé…ç½®
```nginx
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;

location /api {
    limit_req zone=api burst=20;
}
```

---

## ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—

### 1. æ—¥å¿—æ”¶é›†
```bash
# ä½¿ç”¨ELK Stack
docker-compose -f elk-stack.yml up -d
```

### 2. æ€§èƒ½ç›‘æ§
```bash
# Prometheus + Grafana
docker-compose -f monitoring.yml up -d
```

### 3. å‘Šè­¦é…ç½®
- æœåŠ¡å®•æœºå‘Šè­¦
- ç£ç›˜ç©ºé—´å‘Šè­¦
- æ•°æ®åº“è¿æ¥æ•°å‘Šè­¦

---

## ğŸ¯ é€‰æ‹©å»ºè®®

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç†ç”± |
|------|---------|------|
| **ä¸ªäººå­¦ä¹ ** | Dockeræœ¬åœ° | ç®€å•å¿«é€Ÿ |
| **å›¢é˜ŸDemo** | Vercel+Railway | å…è´¹ï¼Œå¿«é€Ÿ |
| **å°å‹é¡¹ç›®** | äº‘æœåŠ¡å™¨+Docker | æ€§ä»·æ¯”é«˜ |
| **ä¸­å‹é¡¹ç›®** | é˜¿é‡Œäº‘ECS+RDS | ç¨³å®šå¯é  |
| **å¤§å‹é¡¹ç›®** | Kubernetes | é«˜å¯ç”¨ï¼Œå¯æ‰©å±• |

---

## ğŸ“ è·å–å¸®åŠ©

éœ€è¦éƒ¨ç½²ååŠ©ï¼Ÿè¯·æä¾›ï¼š
1. é€‰æ‹©çš„éƒ¨ç½²æ–¹æ¡ˆ
2. æœåŠ¡å™¨é…ç½®
3. é‡åˆ°çš„é—®é¢˜

ç¥éƒ¨ç½²é¡ºåˆ©ï¼ğŸ‰
