# ğŸ” Blue-Local é¡¹ç›®å…¨é¢æ£€æŸ¥æŠ¥å‘Š

## ğŸ“‹ æ£€æŸ¥æ—¶é—´: 2025-10-16

---

## âš ï¸ å‘ç°çš„é—®é¢˜å’Œæ”¹è¿›å»ºè®®

### ğŸ”´ ä¸¥é‡é—®é¢˜ (éœ€ç«‹å³ä¿®å¤)

#### 1. **å®‰å…¨å¯†é’¥ç¡¬ç¼–ç ** - é«˜å±
**ä½ç½®**: `backend/security.py:12`
```python
SECRET_KEY = "YOUR_VERY_SECRET_KEY"  # âš ï¸ éœ€è¦æ›´æ¢
```

**é—®é¢˜**: JWT å¯†é’¥ä½¿ç”¨é»˜è®¤å€¼,å­˜åœ¨ä¸¥é‡å®‰å…¨éšæ‚£
**å½±å“**: ä»»ä½•äººéƒ½å¯ä»¥ä¼ªé€  token,è·å–æœªæˆæƒè®¿é—®
**ä¿®å¤æ–¹æ¡ˆ**:
```python
import os
from dotenv import load_dotenv

load_dotenv()
SECRET_KEY = os.getenv("SECRET_KEY", "your-super-secret-key-change-in-production")
```

**å»ºè®®**: 
- åˆ›å»º `.env` æ–‡ä»¶å­˜å‚¨å¯†é’¥
- ä½¿ç”¨ `python -c "import secrets; print(secrets.token_urlsafe(32))"` ç”Ÿæˆå¯†é’¥
- å°† `.env` æ·»åŠ åˆ° `.gitignore`

---

#### 2. **Token è¿‡æœŸæ—¶é—´è¿‡çŸ­**
**ä½ç½®**: `backend/security.py:14`
```python
ACCESS_TOKEN_EXPIRE_MINUTES = 30  # ä»…30åˆ†é’Ÿ
```

**é—®é¢˜**: ç”¨æˆ·ä½“éªŒå·®,é¢‘ç¹éœ€è¦é‡æ–°ç™»å½•
**å»ºè®®**: 
- ä¿®æ”¹ä¸ºè‡³å°‘ `24 * 60` (24å°æ—¶)
- æˆ–å®ç° refresh token æœºåˆ¶

---

### ğŸŸ¡ ä¸­ç­‰é—®é¢˜ (å»ºè®®ä¿®å¤)

#### 3. **é”™è¯¯å¤„ç†ä¸å®Œå–„**
**ä½ç½®**: 
- `frontend/src/views/tools/link-dashboard/LinkDashboard.vue`
- å¤šå¤„ä½¿ç”¨ç®€å•çš„ `console.error` å’Œ `alert`

**é—®é¢˜**:
```javascript
catch (error) {
  console.error('è·å–åˆ†ç±»å¤±è´¥:', error);  // âš ï¸ ç”¨æˆ·çœ‹ä¸åˆ°é”™è¯¯
}
```

**æ”¹è¿›å»ºè®®**:
```javascript
import { ElMessage } from 'element-plus'  // å¦‚æœä½¿ç”¨ Element Plus
// æˆ–è€…è‡ªå·±å®ç° toast æç¤º

catch (error) {
  console.error('è·å–åˆ†ç±»å¤±è´¥:', error);
  const message = error.response?.data?.detail || 'è·å–åˆ†ç±»å¤±è´¥ï¼Œè¯·é‡è¯•';
  ElMessage.error(message);
  // æˆ–è€…è®¾ç½®ä¸€ä¸ªå…¨å±€é”™è¯¯çŠ¶æ€æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š
}
```

**éœ€è¦æ”¹è¿›çš„æ–‡ä»¶**:
- `LinkDashboard.vue` - 6å¤„é”™è¯¯å¤„ç†
- `PostEditorPage.vue` - alert æ›¿æ¢ä¸ºä¼˜é›…æç¤º
- `auth.js` - å·²æœ‰è¾ƒå¥½çš„é”™è¯¯å¤„ç†,å¯ä»¥ç»Ÿä¸€é£æ ¼

---

#### 4. **æ•°æ®åº“è¿æ¥é…ç½®ç¡¬ç¼–ç **
**ä½ç½®**: `backend/database.py` (éœ€è¦æ£€æŸ¥)

**å»ºè®®**: å°†æ•°æ®åº“è¿æ¥ä¿¡æ¯ç§»åˆ°ç¯å¢ƒå˜é‡:
```python
# .env
DATABASE_URL=mysql+pymysql://root:@localhost:3306/blue_local_db

# database.py
import os
SQLALCHEMY_DATABASE_URL = os.getenv("DATABASE_URL")
```

---

#### 5. **ç¼ºå°‘è¯·æ±‚æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç† Token**
**ä½ç½®**: å‰ç«¯å„ä¸ª API è°ƒç”¨

**é—®é¢˜**: æ¯æ¬¡è¯·æ±‚éƒ½æ‰‹åŠ¨æ·»åŠ  Authorization header
```javascript
// âŒ å½“å‰åšæ³• - é‡å¤ä»£ç 
await axios.get('/api/categories', {
  headers: { Authorization: `Bearer ${authStore.token}` }
});
```

**æ”¹è¿›æ–¹æ¡ˆ**: åˆ›å»º axios å®ä¾‹
```javascript
// src/utils/axios.js
import axios from 'axios';
import { useAuthStore } from '@/stores/auth';

const api = axios.create({
  baseURL: '/api'
});

api.interceptors.request.use(config => {
  const authStore = useAuthStore();
  if (authStore.token) {
    config.headers.Authorization = `Bearer ${authStore.token}`;
  }
  return config;
});

api.interceptors.response.use(
  response => response,
  error => {
    if (error.response?.status === 401) {
      // Token è¿‡æœŸ,è‡ªåŠ¨è·³è½¬ç™»å½•
      const authStore = useAuthStore();
      authStore.logout();
      router.push('/login');
    }
    return Promise.reject(error);
  }
);

export default api;
```

ç„¶åå…¨å±€ä½¿ç”¨:
```javascript
import api from '@/utils/axios';
await api.get('/categories');  // è‡ªåŠ¨æºå¸¦ token
```

---

#### 6. **ç¼ºå°‘åŠ è½½çŠ¶æ€å’Œéª¨æ¶å±**
**ä½ç½®**: `LinkDashboard.vue`

**å½“å‰**:
```vue
<div v-if="loading" class="loading">åŠ è½½ä¸­...</div>
```

**æ”¹è¿›**: æ·»åŠ éª¨æ¶å±æå‡ç”¨æˆ·ä½“éªŒ
```vue
<div v-if="loading" class="skeleton-grid">
  <div v-for="i in 6" :key="i" class="skeleton-card">
    <div class="skeleton-icon"></div>
    <div class="skeleton-text"></div>
  </div>
</div>
```

---

### ğŸŸ¢ è½»å¾®é—®é¢˜ (å¯é€‰ä¼˜åŒ–)

#### 7. **æ€§èƒ½ä¼˜åŒ–å»ºè®®**

##### a) åˆ†ç±»åˆ é™¤ç¼ºå°‘ç¡®è®¤
**ä½ç½®**: æš‚æœªå®ç°åˆ†ç±»åˆ é™¤åŠŸèƒ½

**å»ºè®®**: æ·»åŠ åˆ†ç±»åˆ é™¤åŠŸèƒ½,å¹¶åŠ å…¥ç¡®è®¤æç¤º:
```javascript
const deleteCategory = async (categoryId) => {
  if (!confirm('åˆ é™¤åˆ†ç±»å°†åŒæ—¶åˆ é™¤è¯¥åˆ†ç±»ä¸‹çš„æ‰€æœ‰é“¾æ¥,ç¡®å®šç»§ç»­å—?')) return;
  
  try {
    await axios.delete(`/api/categories/${categoryId}`, {
      headers: { Authorization: `Bearer ${authStore.token}` }
    });
    await loadData();
    ElMessage.success('åˆ é™¤æˆåŠŸ');
  } catch (error) {
    ElMessage.error('åˆ é™¤å¤±è´¥');
  }
};
```

##### b) é˜²æŠ–ä¼˜åŒ–æœç´¢
å¦‚æœåç»­æ·»åŠ æœç´¢åŠŸèƒ½,å»ºè®®ä½¿ç”¨é˜²æŠ–:
```javascript
import { debounce } from 'lodash-es';

const searchLinks = debounce(async (keyword) => {
  // æœç´¢é€»è¾‘
}, 300);
```

##### c) å›¾ç‰‡åŠ è½½ä¼˜åŒ–
**ä½ç½®**: `LinkCard.vue`

**å½“å‰**: ç›´æ¥åŠ è½½ favicon
**æ”¹è¿›**: æ·»åŠ æ‡’åŠ è½½å’Œå ä½ç¬¦
```vue
<img 
  v-if="faviconUrl" 
  :src="faviconUrl" 
  loading="lazy"
  @error="onFaviconError"
/>
```

---

#### 8. **ä»£ç è´¨é‡æ”¹è¿›**

##### a) æ·»åŠ  TypeScript ç±»å‹å®šä¹‰
è™½ç„¶æ˜¯ Vue 3,ä½†å¯ä»¥æ·»åŠ  JSDoc ç±»å‹æ³¨é‡Š:
```javascript
/**
 * @typedef {Object} Category
 * @property {number} id
 * @property {string} name
 * @property {string} description
 * @property {number} link_count
 */

/** @type {import('vue').Ref<Category[]>} */
const categories = ref([]);
```

##### b) æå–å¸¸é‡
```javascript
// constants.js
export const API_ENDPOINTS = {
  CATEGORIES: '/api/categories',
  LINKS: '/api/links',
};

export const ERROR_MESSAGES = {
  FETCH_CATEGORIES_FAILED: 'è·å–åˆ†ç±»å¤±è´¥',
  SAVE_CATEGORY_FAILED: 'ä¿å­˜åˆ†ç±»å¤±è´¥',
};
```

##### c) ç»„ä»¶æ‹†åˆ†
`LinkDashboard.vue` ç›®å‰ 371 è¡Œ,å»ºè®®æ‹†åˆ†:
- `DashboardHeader.vue` - é¡¶éƒ¨æ“ä½œæ 
- `CategoriesBar.vue` - åˆ†ç±»æ ‡ç­¾æ 
- `LinksGrid.vue` - é“¾æ¥ç½‘æ ¼

---

#### 9. **æµ‹è¯•è¦†ç›–**

**å½“å‰çŠ¶æ€**: æ— å•å…ƒæµ‹è¯•

**å»ºè®®æ·»åŠ **:
```javascript
// tests/unit/LinkDashboard.spec.js
import { describe, it, expect } from 'vitest';
import { mount } from '@vue/test-utils';
import LinkDashboard from '@/views/tools/link-dashboard/LinkDashboard.vue';

describe('LinkDashboard', () => {
  it('renders properly', () => {
    const wrapper = mount(LinkDashboard);
    expect(wrapper.find('h1').text()).toBe('ğŸ”– ç½‘ç«™æ”¶è—ç®¡ç†');
  });
  
  it('filters links by category', async () => {
    // æµ‹è¯•åˆ†ç±»ç­›é€‰åŠŸèƒ½
  });
});
```

---

#### 10. **å¯è®¿é—®æ€§ (A11y) æ”¹è¿›**

**é—®é¢˜**: 
- ç¼ºå°‘ ARIA æ ‡ç­¾
- é”®ç›˜å¯¼èˆªæ”¯æŒä¸å®Œæ•´

**æ”¹è¿›**:
```vue
<button 
  @click="showAddCategoryModal = true" 
  class="btn-add"
  aria-label="æ–°å»ºåˆ†ç±»"
>
  ï¼‹ æ–°å»ºåˆ†ç±»
</button>

<div 
  class="link-card"
  role="article"
  :aria-label="`é“¾æ¥: ${link.title}`"
  tabindex="0"
  @keydown.enter="openLink"
>
```

---

## ğŸ“Š æ€»ä½“è¯„ä¼°

### âœ… åšå¾—å¥½çš„åœ°æ–¹
1. âœ… ä»£ç ç»“æ„æ¸…æ™°,æ¨¡å—åŒ–è‰¯å¥½
2. âœ… æš—é»‘æ¨¡å¼å®ç°å®Œæ•´
3. âœ… å“åº”å¼è®¾è®¡è€ƒè™‘å‘¨å…¨
4. âœ… RESTful API è®¾è®¡è§„èŒƒ
5. âœ… ç”¨æˆ·æ•°æ®éš”ç¦»æ­£ç¡®
6. âœ… çº§è”åˆ é™¤é€»è¾‘æ­£ç¡®

### ğŸ“ˆ ä¼˜å…ˆçº§å»ºè®®

**ç«‹å³ä¿®å¤** (æœ¬å‘¨):
1. ğŸ”´ æ›´æ¢ SECRET_KEY
2. ğŸ”´ æ·»åŠ  .env ç¯å¢ƒå˜é‡é…ç½®
3. ğŸŸ¡ åˆ›å»º axios æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç† token

**çŸ­æœŸä¼˜åŒ–** (2å‘¨å†…):
4. ğŸŸ¡ æ”¹å–„é”™è¯¯æç¤º (alert â†’ toast)
5. ğŸŸ¡ å»¶é•¿ token æœ‰æ•ˆæœŸæˆ–å®ç° refresh token
6. ğŸŸ¡ æ·»åŠ åˆ†ç±»åˆ é™¤åŠŸèƒ½

**ä¸­æœŸæ”¹è¿›** (1ä¸ªæœˆ):
7. ğŸŸ¢ æ·»åŠ éª¨æ¶å±åŠ è½½çŠ¶æ€
8. ğŸŸ¢ ç»„ä»¶æ‹†åˆ†ä¼˜åŒ–
9. ğŸŸ¢ æ·»åŠ å•å…ƒæµ‹è¯•

**é•¿æœŸè§„åˆ’**:
10. ğŸŸ¢ TypeScript è¿ç§»
11. ğŸŸ¢ å®Œæ•´çš„å¯è®¿é—®æ€§æ”¯æŒ

---

## ğŸ› ï¸ å¿«é€Ÿä¿®å¤è„šæœ¬

### 1. åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
```bash
# é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
cat > backend/.env << EOF
SECRET_KEY=$(python -c "import secrets; print(secrets.token_urlsafe(32))")
DATABASE_URL=mysql+pymysql://root:@localhost:3306/blue_local_db
ACCESS_TOKEN_EXPIRE_MINUTES=1440
# CORS é…ç½®
CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5173
```
EOF
```

### 2. å®‰è£…ä¾èµ–
```bash
cd backend
pip install python-dotenv
```

### 3. æ›´æ–° .gitignore
å·²å®Œæˆ âœ…

---

## ğŸ“ ä¸‹æ¬¡è¿­ä»£å»ºè®®

1. **æœç´¢åŠŸèƒ½**: æ·»åŠ é“¾æ¥æœç´¢
2. **å¯¼å…¥/å¯¼å‡º**: æ”¯æŒä¹¦ç­¾å¯¼å…¥
3. **æ ‡ç­¾ç³»ç»Ÿ**: å¤šç»´åº¦åˆ†ç±»
4. **é“¾æ¥é¢„è§ˆ**: æ‚¬åœæ˜¾ç¤ºç½‘ç«™æˆªå›¾
5. **æ‰¹é‡æ“ä½œ**: æ‰¹é‡åˆ é™¤/ç§»åŠ¨é“¾æ¥

---

**æ£€æŸ¥å®Œæˆæ—¶é—´**: 2025-10-16  
**æ£€æŸ¥èŒƒå›´**: å…¨æ ˆä»£ç  + å®‰å…¨ + æ€§èƒ½ + ç”¨æˆ·ä½“éªŒ  
**æ€»ä½“è¯„åˆ†**: 7.5/10 (è‰¯å¥½,æœ‰æ”¹è¿›ç©ºé—´)
