# 管理员系统使用指南

## 📋 功能概述

已为您的博客系统实现了完整的管理员功能,包括:

### 1. **用户角色系统**
- ✅ 管理员角色 (`admin`) - 拥有完整管理权限
- ✅ 普通用户角色 (`user`) - 普通访问权限
- ✅ **第一个注册的用户自动成为管理员**

### 2. **用户管理功能** (仅管理员可见)
- 📋 查看所有用户列表
- ✏️ 编辑用户信息 (邮箱、角色、状态)
- 🔒 禁用/启用用户账号
- 🗑️ 删除用户 (无法删除自己)
- 👁️ 查看用户详细信息

### 3. **个人账号管理** (所有用户)
- 🔑 修改个人密码
- 👤 查看个人信息
- ⚙️ 管理个人设置

---

## 🚀 使用说明

### **访问管理员后台**

1. **登录您的账号** (第一个注册的用户)
2. **访问个人中心**: 点击导航栏的"个人主页"
3. **进入用户管理**: 如果您是管理员,会看到"管理员功能"模块,点击"🔧 用户管理"

或直接访问: `http://localhost:5173/admin/users`

---

### **修改个人密码**

1. 访问 **个人主页** (`/profile`)
2. 在"修改密码"卡片中填写:
   - 当前密码
   - 新密码 (至少6个字符)
   - 确认新密码
3. 点击"修改密码"按钮

---

### **管理用户** (管理员专用)

#### **查看用户列表**
访问 `/admin/users` 可以看到所有用户的:
- ID
- 用户名
- 邮箱
- 角色 (管理员/普通用户)
- 状态 (正常/已禁用)
- 注册时间

#### **编辑用户**
1. 点击用户行的"编辑"按钮
2. 可以修改:
   - 邮箱地址
   - 角色 (管理员/普通用户)
   - 状态 (正常/已禁用)
3. 点击"保存"确认修改

**限制**:
- ⚠️ 管理员无法修改自己的角色
- ⚠️ 管理员无法删除自己

#### **禁用/启用用户**
1. 点击用户行的"禁用"或"启用"按钮
2. 确认操作
3. 被禁用的用户将无法登录系统

#### **删除用户**
1. 点击用户行的"删除"按钮
2. 确认删除 (不可恢复!)
3. 用户及其所有数据将被永久删除

---

## 🔐 安全说明

### **权限保护**
- ✅ 所有管理员 API 都需要验证 token
- ✅ 自动检查用户角色,非管理员无法访问
- ✅ 防止管理员删除或修改自己的关键信息
- ✅ 禁用账号后无法登录

### **数据库字段**
在 `users` 表中新增了以下字段:
- `role` - 用户角色 ('admin' 或 'user')
- `is_active` - 账号状态 (TRUE 正常, FALSE 已禁用)
- `updated_at` - 最后更新时间

---

## 📍 API 端点

### **用户个人 API**
- `GET /api/users/me` - 获取当前用户信息
- `PUT /api/users/me/password` - 修改密码

### **管理员 API** (需要 admin 角色)
- `GET /api/admin/users` - 获取所有用户列表
- `GET /api/admin/users/{user_id}` - 获取指定用户详情
- `PUT /api/admin/users/{user_id}` - 更新用户信息
- `DELETE /api/admin/users/{user_id}` - 删除用户

---

## 🎯 下一步建议

现在管理员系统已经完成,您可以:

1. **测试管理功能**
   - 注册几个测试账号
   - 用管理员账号管理这些用户
   - 测试禁用/启用功能

2. **开始实现博客功能**
   - 文章创建/编辑
   - 富文本编辑器
   - 文章列表和详情页

3. **增强管理功能**
   - 用户统计面板
   - 文章管理
   - 系统日志

---

## ❓ 常见问题

**Q: 如何设置第一个管理员?**
A: 数据库更新脚本会自动将第一个注册的用户设为管理员。如果数据库中已有用户,第一个用户已被设为管理员。

**Q: 忘记管理员密码怎么办?**
A: 可以在 HeidiSQL 中直接修改数据库,或联系开发人员重置。

**Q: 普通用户如何成为管理员?**
A: 由现有管理员在用户管理页面中修改其角色为"管理员"。

**Q: 管理员可以删除自己吗?**
A: 不可以,系统会阻止这个操作。

---

## ✅ 完成情况

- ✅ 用户角色系统
- ✅ 数据库表结构更新
- ✅ 后端 API 实现
- ✅ 管理员页面
- ✅ 个人设置页面
- ✅ 权限验证
- ✅ 安全保护

**立即尝试**: 刷新浏览器,访问"个人主页"开始使用! 🚀
