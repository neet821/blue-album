# 🚀 快速修复清单 - 优先级排序

## ⏰ 立即修复 (今天完成)

### 1. 安全密钥配置 ⭐⭐⭐⭐⭐
```bash
# 步骤1: 生成安全密钥
python -c "import secrets; print(secrets.token_urlsafe(32))"

# 步骤2: 创建 .env 文件
# backend/.env
SECRET_KEY=你生成的密钥
DATABASE_URL=mysql+pymysql://root:@localhost:3306/blue_local_db
ACCESS_TOKEN_EXPIRE_MINUTES=1440
```

```python
# 步骤3: 修改 backend/security.py
import os
from dotenv import load_dotenv

load_dotenv()
SECRET_KEY = os.getenv("SECRET_KEY")
ACCESS_TOKEN_EXPIRE_MINUTES = int(os.getenv("ACCESS_TOKEN_EXPIRE_MINUTES", 1440))
```

```bash
# 步骤4: 安装依赖
pip install python-dotenv
```

**预计时间**: 10分钟  
**优先级**: 🔴 紧急

---

### 2. 创建 axios 拦截器 ⭐⭐⭐⭐
创建 `frontend/src/utils/request.js`:

```javascript
import axios from 'axios';
import { useAuthStore } from '@/stores/auth';
import router from '@/router';

const request = axios.create({
  baseURL: '/api',
  timeout: 10000
});

// 请求拦截器
request.interceptors.request.use(
  config => {
    const authStore = useAuthStore();
    if (authStore.token) {
      config.headers.Authorization = `Bearer ${authStore.token}`;
    }
    return config;
  },
  error => Promise.reject(error)
);

// 响应拦截器
request.interceptors.response.use(
  response => response,
  error => {
    if (error.response?.status === 401) {
      const authStore = useAuthStore();
      authStore.logout();
      router.push('/login');
    }
    return Promise.reject(error);
  }
);

export default request;
```

然后全局替换 axios 为 request

**预计时间**: 20分钟  
**优先级**: 🟡 重要

---

## 📅 本周完成

### 3. 改进错误提示 ⭐⭐⭐
安装 toast 库或使用简单提示:

```bash
npm install vue-toastification
```

```javascript
// main.js
import Toast from 'vue-toastification';
import 'vue-toastification/dist/index.css';

app.use(Toast);
```

```javascript
// LinkDashboard.vue
import { useToast } from 'vue-toastification';
const toast = useToast();

catch (error) {
  console.error('获取分类失败:', error);
  toast.error(error.response?.data?.detail || '获取分类失败');
}
```

**预计时间**: 30分钟  
**优先级**: 🟡 重要

---

### 4. 添加分类删除功能 ⭐⭐⭐
在 `CategoryModal.vue` 添加删除按钮:

```vue
<button 
  v-if="category" 
  @click="$emit('delete', category.id)"
  class="btn-delete"
>
  删除分类
</button>
```

在 `LinkDashboard.vue` 添加处理:

```javascript
const deleteCategory = async (categoryId) => {
  if (!confirm('删除分类将同时删除该分类下的所有链接,确定吗?')) return;
  
  try {
    await axios.delete(`/api/categories/${categoryId}`, {
      headers: { Authorization: `Bearer ${authStore.token}` }
    });
    await loadData();
    toast.success('删除成功');
  } catch (error) {
    toast.error('删除失败');
  }
};
```

**预计时间**: 15分钟  
**优先级**: 🟢 一般

---

## 🗓️ 下周完成

### 5. 添加加载骨架屏 ⭐⭐
```vue
<!-- LinkDashboard.vue -->
<div v-if="loading" class="skeleton-container">
  <div v-for="i in 6" :key="i" class="skeleton-card">
    <div class="skeleton-icon"></div>
    <div class="skeleton-line"></div>
    <div class="skeleton-line short"></div>
  </div>
</div>

<style scoped>
.skeleton-card {
  background: var(--primary-bg);
  padding: 16px;
  border-radius: 12px;
  animation: pulse 1.5s ease-in-out infinite;
}

.skeleton-icon {
  width: 40px;
  height: 40px;
  background: var(--border-color);
  border-radius: 8px;
  margin-bottom: 12px;
}

.skeleton-line {
  height: 12px;
  background: var(--border-color);
  border-radius: 4px;
  margin-bottom: 8px;
}

.skeleton-line.short {
  width: 60%;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
</style>
```

**预计时间**: 20分钟  
**优先级**: 🟢 一般

---

### 6. 数据库配置环境变量 ⭐⭐
```python
# backend/database.py
import os
from dotenv import load_dotenv

load_dotenv()

SQLALCHEMY_DATABASE_URL = os.getenv(
    "DATABASE_URL",
    "mysql+pymysql://root:@localhost:3306/blue_local_db"
)
```

**预计时间**: 5分钟  
**优先级**: 🟢 一般

---

## 📦 可选优化 (有时间再做)

### 7. 组件拆分
- [ ] DashboardHeader.vue
- [ ] CategoriesBar.vue
- [ ] LinksGrid.vue

### 8. 添加单元测试
- [ ] LinkDashboard.spec.js
- [ ] LinkCard.spec.js
- [ ] CategoryModal.spec.js

### 9. TypeScript 迁移
- [ ] 逐步迁移到 TypeScript

### 10. 可访问性改进
- [ ] 添加 ARIA 标签
- [ ] 键盘导航支持

---

## 📊 完成进度追踪

- [ ] 1. 安全密钥配置 (10min)
- [ ] 2. axios 拦截器 (20min)
- [ ] 3. 改进错误提示 (30min)
- [ ] 4. 分类删除功能 (15min)
- [ ] 5. 加载骨架屏 (20min)
- [ ] 6. 数据库环境变量 (5min)

**总预计时间**: 约 1.5 小时

---

## 🎯 建议工作流程

**今天**:
1. ✅ 修复安全密钥 (最重要!)
2. ✅ 创建 axios 拦截器

**明天**:
3. ✅ 改进错误提示
4. ✅ 添加分类删除

**后天**:
5. ✅ 添加骨架屏
6. ✅ 测试所有功能

然后就可以继续开发下一个工具: **多人音视频同步** 🎬

---

**创建时间**: 2025-10-16  
**预计完成**: 本周内
