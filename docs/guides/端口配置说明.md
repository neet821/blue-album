# 🔧 端口配置说明

**创建时间:** 2025年10月16日  
**更新原因:** 统一前端端口配置

---

## 📌 正确的端口配置

### 当前使用的端口

| 服务 | 端口 | 访问地址 | 说明 |
|------|------|----------|------|
| **前端 (Vite)** | `5173` | http://localhost:5173 | Vite 默认端口 |
| **后端 (FastAPI)** | `8000` | http://localhost:8000 | Uvicorn 默认端口 |
| **API 文档** | `8000` | http://localhost:8000/docs | FastAPI 自动生成 |

---

## ⚠️ 历史端口问题

### 问题发现
在检查项目文件时发现文档中同时存在 `5173` 和 `5174` 两个端口号:

- ❌ **5174** - 错误端口(早期文档记录)
- ✅ **5173** - 正确端口(Vite 默认)

### 原因分析
根据 `第一阶段完成总结.md` 的记录:
> "前端运行在 5174 端口 (5173 被占用)"

这说明在项目早期开发时,5173 端口可能被其他应用占用,临时使用了 5174。但现在:
- ✅ `vite.config.js` 中**没有指定端口**,使用 Vite 默认的 **5173**
- ✅ 前端实际运行在 **5173** 端口

---

## ✅ 已修复的文件

### 1. 核心配置文件
- [x] `backend/.env` - CORS_ORIGINS 更新为 5173
  ```properties
  CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5173
  ```

### 2. 文档文件
- [x] `测试清单.md` - 所有 5174 改为 5173
- [x] `项目检查报告.md` - CORS 配置示例更新

### 3. 后端代码
- [x] `backend/main.py` - CORS 中间件已包含 5173 和 5174(兼容)
  ```python
  origins = [
      "http://localhost:5173",      # 当前使用
      "http://127.0.0.1:5173",      # 当前使用
      "http://localhost:5174",      # 保留以防万一
      "http://127.0.0.1:5174",      # 保留以防万一
      "http://localhost:8000",
  ]
  ```

---

## 📝 需要手动更新的文档

以下文档中仍包含 5174 端口,建议根据实际情况更新:

### 历史记录文档 (可选更新)
- `第一阶段完成总结.md` - 包含 5174 的历史说明
- `暗黑模式使用指南.md` - 3 处 5174
- `链接管理工具使用指南.md` - 2 处 5174
- `路径别名问题修复.md` - 2 处 5174

### 测试文件 (建议更新)
- `test_cors.py` - Origin 头部使用 5174

### 其他文档 (已正确)
- ✅ `阶段2_完成总结.md` - 使用 5173
- ✅ `阶段1_用户与管理员系统总结.md` - 使用 5173
- ✅ `管理员系统使用指南.md` - 使用 5173
- ✅ `bcrypt问题解决.md` - 使用 5173

---

## 🎯 标准化建议

### 1. Vite 配置 (可选)
如果希望明确指定端口,可以在 `vite.config.js` 中添加:

```javascript
export default defineConfig({
  plugins: [vue()],
  server: {
    port: 5173,  // 明确指定端口
    proxy: {
      '/api': {
        target: 'http://127.0.0.1:8000',
        changeOrigin: true,
      }
    }
  }
})
```

### 2. 环境变量
后端已使用 `.env` 配置 CORS,如需修改端口只需更新:
```properties
CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5173
```

### 3. 文档规范
今后所有文档应统一使用:
- 前端: `http://localhost:5173`
- 后端: `http://localhost:8000`

---

## 🔍 快速验证

### 验证前端端口
```powershell
# 启动前端后,检查输出
npm run dev

# 输出应显示:
# Local:   http://localhost:5173/
```

### 验证后端 CORS
访问 http://localhost:8000/docs 检查 API 文档是否正常加载

### 验证浏览器访问
直接访问 http://localhost:5173 应能正常打开前端页面

---

**总结:** 项目当前使用 **5173** 作为前端端口,所有新文档应使用此端口号。
