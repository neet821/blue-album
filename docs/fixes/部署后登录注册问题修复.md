# éƒ¨ç½²åç™»å½•æ³¨å†Œé—®é¢˜ä¿®å¤æŒ‡å—

## ğŸ” é—®é¢˜è¯Šæ–­

### é—®é¢˜æè¿°
éƒ¨ç½²åˆ°æœåŠ¡å™¨åï¼Œå‰ç«¯æ— æ³•æ­£å¸¸ç™»å½•å’Œæ³¨å†Œï¼Œå¯èƒ½å‡ºç°çš„é”™è¯¯ï¼š
- ç½‘ç»œé”™è¯¯ï¼šæ— æ³•è¿æ¥åˆ°åç«¯API
- CORSé”™è¯¯ï¼šè·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢
- 404é”™è¯¯ï¼šAPIç«¯ç‚¹ä¸å­˜åœ¨

### æ ¹æœ¬åŸå› 
1. **å‰ç«¯ç¡¬ç¼–ç APIåœ°å€**ï¼šå‰ç«¯ä»£ç ä¸­ç¡¬ç¼–ç äº† `http://localhost:8000`
2. **CORSé…ç½®ä¸å®Œæ•´**ï¼šç”Ÿäº§ç¯å¢ƒçš„CORS originsæœªæ­£ç¡®é…ç½®
3. **ç¯å¢ƒå˜é‡ç¼ºå¤±**ï¼šæœåŠ¡å™¨ç¼ºå°‘å¿…è¦çš„ç¯å¢ƒé…ç½®

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. å‰ç«¯APIåœ°å€ä¿®å¤

#### å·²ä¿®å¤çš„æ–‡ä»¶ï¼š
- `frontend/src/utils/api.js` - æ–°å¢APIé…ç½®å·¥å…·
- `frontend/src/stores/auth.js` - ä½¿ç”¨æ–°çš„APIé…ç½®
- `frontend/src/views/PostsPage.vue` - ç§»é™¤ç¡¬ç¼–ç åœ°å€
- `frontend/src/views/PostDetailPage.vue` - ç§»é™¤ç¡¬ç¼–ç åœ°å€
- `frontend/src/views/AuthorPage.vue` - ç§»é™¤ç¡¬ç¼–ç åœ°å€

#### ä¿®å¤åŸç†ï¼š
```javascript
// âŒ é”™è¯¯ï¼šç¡¬ç¼–ç åœ°å€
const response = await axios.post('http://localhost:8000/api/users/register', data);

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„
const response = await apiClient.post(API_ENDPOINTS.REGISTER, data);
```

### 2. åç«¯CORSé…ç½®ä¿®å¤

#### å·²ä¿®å¤çš„æ–‡ä»¶ï¼š
- `backend/main.py` - åŠ¨æ€åŠ è½½CORSé…ç½®

#### ä¿®å¤å†…å®¹ï¼š
```python
# ä»é…ç½®ä¸­è·å–CORS origins
from .config import config

# æ·»åŠ é…ç½®ä¸­çš„CORS origins
if hasattr(config, 'CORS_ORIGINS'):
    origins.extend(config.CORS_ORIGINS)
```

### 3. ç¯å¢ƒå˜é‡é…ç½®

#### æœåŠ¡å™¨ç«¯éœ€è¦åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºé…ç½®æ–‡ä»¶
cd /var/www/blue-local/backend
nano .env
```

#### é…ç½®å†…å®¹ï¼š
```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL=mysql+pymysql://blue_user:your_password@127.0.0.1:3306/blue_local_db
DB_HOST=127.0.0.1
DB_PORT=3306
DB_USER=blue_user
DB_PASSWORD=your_strong_password
DB_NAME=blue_local_db

# JWTé…ç½®
SECRET_KEY=your-very-long-secret-key-at-least-32-characters
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# æœåŠ¡å™¨é…ç½®
HOST=0.0.0.0
PORT=8000

# CORSé…ç½®ï¼ˆé‡è¦ï¼ï¼‰
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com,http://yourdomain.com

# ç¯å¢ƒç±»å‹
ENV=production

# æ—¥å¿—çº§åˆ«
LOG_LEVEL=INFO
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. é‡æ–°æ„å»ºå‰ç«¯

```bash
# åœ¨æœ¬åœ°é‡æ–°æ„å»ºå‰ç«¯
cd frontend
npm run build
```

### 2. ä¸Šä¼ ä¿®å¤åçš„ä»£ç 

```bash
# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r frontend/dist user@server:/var/www/blue-local/frontend/
scp -r backend user@server:/var/www/blue-local/
```

### 3. é…ç½®æœåŠ¡å™¨ç¯å¢ƒ

```bash
# SSHåˆ°æœåŠ¡å™¨
ssh user@server

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /var/www/blue-local

# åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶
cp backend/.env.example backend/.env
nano backend/.env

# è®¾ç½®æ–‡ä»¶æƒé™
sudo chown -R www-data:www-data /var/www/blue-local
sudo chmod -R 755 /var/www/blue-local
```

### 4. é‡å¯æœåŠ¡

```bash
# å¦‚æœä½¿ç”¨Docker
docker-compose down
docker-compose up -d

# å¦‚æœä½¿ç”¨Supervisor
sudo supervisorctl restart blue-local-backend

# å¦‚æœä½¿ç”¨systemd
sudo systemctl restart blue-local
sudo systemctl restart nginx
```

## ğŸ” éªŒè¯ä¿®å¤

### 1. æ£€æŸ¥APIè¿æ¥

```bash
# æµ‹è¯•APIç«¯ç‚¹
curl http://your-server-ip/api/docs
curl http://your-server-ip/api/posts
```

### 2. æ£€æŸ¥CORSé…ç½®

åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹ï¼š
- Networkæ ‡ç­¾é¡µï¼šAPIè¯·æ±‚æ˜¯å¦æˆåŠŸ
- Consoleæ ‡ç­¾é¡µï¼šæ˜¯å¦æœ‰CORSé”™è¯¯

### 3. æµ‹è¯•ç™»å½•æ³¨å†Œ

1. è®¿é—®ç½‘ç«™é¦–é¡µ
2. ç‚¹å‡»"ç™»å½•"æˆ–"æ³¨å†Œ"
3. å¡«å†™è¡¨å•å¹¶æäº¤
4. æ£€æŸ¥æ˜¯å¦æˆåŠŸ

## ğŸ› ï¸ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šä»ç„¶æ— æ³•è¿æ¥API

**æ£€æŸ¥é¡¹ï¼š**
- æœåŠ¡å™¨é˜²ç«å¢™æ˜¯å¦å¼€æ”¾8000ç«¯å£
- Nginxé…ç½®æ˜¯å¦æ­£ç¡®ä»£ç†APIè¯·æ±‚
- åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥ç«¯å£
sudo netstat -tlnp | grep 8000

# æ£€æŸ¥Nginxé…ç½®
sudo nginx -t
sudo systemctl restart nginx

# æ£€æŸ¥åç«¯æ—¥å¿—
tail -f /var/log/blue-local-backend.log
```

### é—®é¢˜2ï¼šCORSé”™è¯¯

**æ£€æŸ¥é¡¹ï¼š**
- `.env`æ–‡ä»¶ä¸­çš„CORS_ORIGINSé…ç½®
- å‰ç«¯åŸŸåæ˜¯å¦åœ¨CORSç™½åå•ä¸­

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥CORSé…ç½®
cat backend/.env | grep CORS_ORIGINS

# ç¡®ä¿åŒ…å«å‰ç«¯åŸŸå
CORS_ORIGINS=https://yourdomain.com,http://yourdomain.com
```

### é—®é¢˜3ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥é¡¹ï¼š**
- æ•°æ®åº“æœåŠ¡æ˜¯å¦è¿è¡Œ
- æ•°æ®åº“ç”¨æˆ·æƒé™
- è¿æ¥å­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥MySQLçŠ¶æ€
sudo systemctl status mysql

# æµ‹è¯•æ•°æ®åº“è¿æ¥
mysql -h 127.0.0.1 -u blue_user -p blue_local_db

# æ£€æŸ¥.envé…ç½®
cat backend/.env | grep DB_
```

## ğŸ“‹ æ£€æŸ¥æ¸…å•

- [ ] å‰ç«¯ä»£ç å·²æ›´æ–°ï¼ˆç§»é™¤ç¡¬ç¼–ç APIåœ°å€ï¼‰
- [ ] åç«¯CORSé…ç½®å·²æ›´æ–°
- [ ] æœåŠ¡å™¨ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] å‰ç«¯å·²é‡æ–°æ„å»º
- [ ] æœåŠ¡å·²é‡å¯
- [ ] APIç«¯ç‚¹å¯è®¿é—®
- [ ] ç™»å½•æ³¨å†ŒåŠŸèƒ½æ­£å¸¸

## ğŸ¯ é¢„é˜²æªæ–½

1. **ä½¿ç”¨ç¯å¢ƒå˜é‡**ï¼šæ‰€æœ‰é…ç½®éƒ½é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†
2. **ç›¸å¯¹è·¯å¾„**ï¼šå‰ç«¯ä½¿ç”¨ç›¸å¯¹è·¯å¾„è€Œéç»å¯¹è·¯å¾„
3. **é…ç½®éªŒè¯**ï¼šéƒ¨ç½²å‰éªŒè¯æ‰€æœ‰é…ç½®
4. **æ—¥å¿—ç›‘æ§**ï¼šå®šæœŸæ£€æŸ¥æœåŠ¡æ—¥å¿—

---

**ä¿®å¤å®Œæˆåï¼Œç™»å½•æ³¨å†ŒåŠŸèƒ½åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼** âœ…
