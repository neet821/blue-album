# 🧪 功能测试清单

**创建时间:** 2025年10月16日  
**状态:** ✅ 前后端服务器已启动

--- 

## 📋 本次修复内容

### 1. ✅ 安全性修复 (CRITICAL)
- [x] SECRET_KEY 从硬编码改为环境变量
- [x] DATABASE_URL 配置化  
- [x] Token 过期时间延长至 24 小时
- [x] .env 文件已添加到 .gitignore

### 2. ✅ 代码质量提升 (HIGH)
- [x] 创建 axios 拦截器 (`frontend/src/utils/request.js`)
- [x] 自动注入 Authorization token
- [x] 401 自动登出并跳转到登录页
- [x] 删除了 6+ 处重复的 Authorization 头部代码

### 3. ✅ 功能完善 (MEDIUM)
- [x] 分类删除功能(带级联删除确认)
- [x] 分类编辑功能(右键点击分类标签)
- [x] 完整的分类 CRUD 操作

---

## 🔍 需要测试的功能

### 一、认证与授权测试

#### 1.1 登录功能

- [ ] 访问 http://localhost:5173/login
- [ ] 使用正确的用户名和密码登录
- [ ] 验证是否成功跳转到首页
- [ ] 打开浏览器开发者工具 → Application → Local Storage
- [ ] 确认 `token` 已保存

#### 1.2 Token 自动注入测试

- [ ] 登录后访问链接管理工具页面
- [ ] 打开开发者工具 → Network 标签
- [ ] 清空网络日志(点击 🚫 图标)
- [ ] 刷新页面,查看 API 请求
- [ ] **重要:** 只检查 API 请求(以 `/api` 开头的请求),不要检查静态资源
- [ ] 找到类似这些的请求:
  - `http://localhost:8000/api/categories` 
  - `http://localhost:8000/api/links`
- [ ] 点击某个 API 请求 → Headers 标签 → Request Headers
- [ ] 确认包含 `Authorization: Bearer <token>`
- [ ] **预期结果:** 所有 API 请求自动包含 token,静态资源(如 .svg, .js, .css)不包含 token

#### 1.3 Token 过期测试 (24小时)
- [ ] 查看当前 token 的过期时间
- [ ] 确认设置为 1440 分钟(24小时)
- [ ] **预期结果:** 用户可以保持登录状态 24 小时

#### 1.4 401 自动登出测试
- [ ] 手动删除 LocalStorage 中的 token
- [ ] 尝试访问受保护的页面
- [ ] **预期结果:** 自动跳转到 `/login` 页面,并显示 "登录已过期,请重新登录" 提示

---

### 二、链接管理工具测试

#### 2.1 访问链接管理

- [ ] 登录后点击 "工具" → "链接管理工具"
- [ ] 访问 http://localhost:5173/tools/link-dashboard
- [ ] 确认页面正常加载

#### 2.2 分类显示
- [ ] 确认已有的分类正常显示在左侧标签栏
- [ ] 点击不同分类,确认对应的链接正常切换

#### 2.3 添加分类
- [ ] 点击 "+ 添加分类" 按钮
- [ ] 在模态框中输入分类名称和描述
- [ ] 点击"保存"
- [ ] **预期结果:** 
  - 新分类出现在分类列表中
  - 模态框自动关闭
  - 不需要手动刷新页面

#### 2.4 编辑分类 (新功能)
- [ ] **方法一:** 在已有分类标签上 **右键点击**
- [ ] **方法二:** 在分类编辑模态框中点击 "🗑️ 删除分类" 旁边的编辑按钮
- [ ] 修改分类名称或描述
- [ ] 点击"保存"
- [ ] **预期结果:** 分类信息更新成功

#### 2.5 删除分类 (新功能)
- [ ] **步骤 1:** 右键点击要删除的分类标签
- [ ] **步骤 2:** 在弹出的编辑模态框中,点击 "🗑️ 删除分类" 按钮
- [ ] **步骤 3:** 在确认对话框中查看提示信息
  - 如果分类下有链接,会显示: "确定要删除该分类吗?该分类下的所有链接也会被删除!"
  - 如果分类为空,显示: "确定要删除该分类吗?"
- [ ] **步骤 4:** 点击"确定"
- [ ] **预期结果:**
  - 分类及其下的所有链接被删除
  - 分类列表自动更新
  - 如果删除的是当前选中的分类,自动切换到第一个分类

#### 2.6 添加链接
- [ ] 选择一个分类
- [ ] 点击 "+ 添加链接" 按钮
- [ ] 填写标题、URL、描述
- [ ] 点击"保存"
- [ ] **预期结果:** 链接出现在当前分类下

#### 2.7 编辑链接
- [ ] 点击链接卡片上的编辑按钮
- [ ] 修改链接信息
- [ ] 保存
- [ ] **预期结果:** 链接信息更新成功

#### 2.8 删除链接
- [ ] 点击链接卡片上的删除按钮
- [ ] 确认删除
- [ ] **预期结果:** 链接被删除

---

### 三、错误处理测试

#### 3.1 网络错误处理
- [ ] 关闭后端服务器
- [ ] 尝试访问链接管理工具
- [ ] **预期结果:** 显示友好的错误提示(而非白屏)

#### 3.2 请求超时测试
- [ ] 拦截器设置了 10 秒超时
- [ ] 如果请求超过 10 秒,应显示超时错误

---

## 🐛 已知问题(待优化)

### 低优先级
1. **Toast 通知:** 当前使用 `alert()` 显示提示,建议升级为 `vue-toastification`
2. **加载状态:** 删除操作没有加载动画,建议添加骨架屏
3. **单元测试:** 新功能缺少单元测试

---

## 📝 测试记录

| 测试项 | 状态 | 测试人 | 测试时间 | 备注 |
|--------|------|--------|----------|------|
| 1.1 登录功能 | ✅ 通过 | neet821 | 2025-10-19 | 成功登录,token 已保存 |
| 1.2 Token 自动注入 | ✅ 通过 | neet821 | 2025-10-19 | API 请求自动包含 Authorization |
| 1.3 Token 过期时间 | ✅ 通过 | neet821 | 2025-10-19 | exp=1760930603 (24小时) |
| 1.4 401 自动登出 | ✅ 通过 | neet821 | 2025-10-19 | 拦截器正常,改用登录页消息显示 |
| 2.1 访问链接管理 | ⏳ 待测试 | - | - | - |
| 2.2 分类显示 | ⏳ 待测试 | - | - | - |
| 2.3 添加分类 | ⏳ 待测试 | - | - | - |
| 2.4 编辑分类 | ⏳ 待测试 | - | - | - |
| 2.5 删除分类 | ⏳ 待测试 | - | - | - |
| 2.6 添加链接 | ⏳ 待测试 | - | - | - |
| 2.7 编辑链接 | ⏳ 待测试 | - | - | - |
| 2.8 删除链接 | ⏳ 待测试 | - | - | - |
| 3.1 网络错误处理 | ⏳ 待测试 | - | - | - |
| 3.2 请求超时 | ⏳ 待测试 | - | - | - |

---

## 🚀 测试完成后的下一步

### 如果测试通过:
```powershell
# 1. 提交代码
git add .
git commit -m "fix: 修复安全性问题并完善分类管理功能

- 添加环境变量配置(.env)
- SECRET_KEY 和 DATABASE_URL 配置化
- 创建 axios 拦截器自动处理认证
- 完善分类 CRUD 功能(删除和编辑)
- 延长 token 过期时间至 24 小时
- 添加右键编辑分类功能"

# 2. 推送到远程仓库
git push origin master
```

### 如果发现问题:
1. 记录问题详情(截图、错误信息)
2. 在测试记录表中标注
3. 提交 issue 或修复 bug

---

## 📌 快速访问链接

- **前端地址:** http://localhost:5173
- **后端 API:** http://localhost:8000
- **API 文档:** http://localhost:8000/docs
- **链接管理工具:** http://localhost:5173/tools/link-dashboard

---

**测试人签名:** __________  
**测试日期:** 2025年10月16日
