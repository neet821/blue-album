# 立即开始 - 3分钟启动指南

## 第一步: 安装依赖 (1分钟)

### 后端依赖
```powershell
cd backend
pip install python-socketio
```

### 前端依赖
```powershell
cd frontend
npm install socket.io-client
```

## 第二步: 创建数据库表 (30秒)

打开MySQL客户端或Laragon的phpMyAdmin,执行:

```sql
USE blue_local;

CREATE TABLE sync_rooms (
    id INT PRIMARY KEY AUTO_INCREMENT,
    room_code VARCHAR(20) UNIQUE NOT NULL,
    room_name VARCHAR(100) NOT NULL,
    host_user_id INT NOT NULL,
    control_mode VARCHAR(20) DEFAULT 'host_only' NOT NULL,
    mode VARCHAR(20) DEFAULT 'link' NOT NULL,
    video_source TEXT,
    video_hash VARCHAR(64),
    current_time INT DEFAULT 0,
    is_playing BOOLEAN DEFAULT FALSE,
    is_active BOOLEAN DEFAULT TRUE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (host_user_id) REFERENCES users(id),
    INDEX idx_room_code (room_code)
);

CREATE TABLE sync_room_members (
    id INT PRIMARY KEY AUTO_INCREMENT,
    room_id INT NOT NULL,
    user_id INT NOT NULL,
    nickname VARCHAR(50),
    is_verified BOOLEAN DEFAULT TRUE,
    joined_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (room_id) REFERENCES sync_rooms(id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id),
    UNIQUE KEY unique_room_member (room_id, user_id)
);

CREATE TABLE sync_room_messages (
    id INT PRIMARY KEY AUTO_INCREMENT,
    room_id INT NOT NULL,
    user_id INT NOT NULL,
    message TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (room_id) REFERENCES sync_rooms(id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

## 第三步: 重启服务 (30秒)

### 停止当前服务
在运行uvicorn的终端按 `Ctrl+C`

### 启动后端
```powershell
cd backend
uvicorn main:app --reload
```

### 前端会自动重新加载
如果没有,手动刷新浏览器

## 第四步: 测试 (1分钟)

1. 访问: http://localhost:5173/tools/sync-room
2. 点击"创建房间"
3. 填写:
   - 房间名称: 测试房间
   - 播放模式: 外部链接
   - 视频链接: https://www.w3schools.com/html/mov_bbb.mp4
   - 控制模式: 仅房主控制
4. 点击"创建房间"

## 测试视频链接

```
https://www.w3schools.com/html/mov_bbb.mp4
https://www.w3schools.com/html/movie.mp4
```

## 完成! 🎉

现在可以:
- 创建房间邀请朋友
- 同步观看视频
- 实时聊天交流

## 快速故障排除

### 问题: pip install 失败
```powershell
pip install python-socketio -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 问题: npm install 失败
```powershell
npm install socket.io-client --registry=https://registry.npmmirror.com
```

### 问题: 找不到表
重新执行第二步的SQL脚本

### 问题: WebSocket连接失败
确保后端在8000端口运行,检查main.py是否已保存

## 功能特性

✅ 外部链接视频播放
✅ 实时播放同步
✅ 双控制模式(房主/全员)
✅ 文字聊天
✅ 成员列表
✅ 房间管理

准备好了! 开始使用吧! 🚀
